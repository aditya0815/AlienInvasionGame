var galleryLoaded;
galleryLoaded||(galleryLoaded=!0,function(b){phx.loader||(phx.loader={});phx.loader.ImageQueue=function(b){this.cnf=b;this.cnf.maxLoadParallel=this.cnf.maxLoadParallel||4;this.queue=[];this.activeElements=[];this.imageEvents=["onload","onerror","onabort"];this.add=function(b){this.queue.push(b);this.refillActive()};this.startQueue=function(){this.refillActive()};this._filterActiveElements=function(b){return function(g){return g===b}};this.filterActiveElement=function(b){this.activeElements=this.activeElements.filter(this._filterActiveElements(b))};
this._createImageHandler=function(b){var g=this;return function(){b&&b.apply(this);g.filterActiveElement(this);g.refillActive()}};this.refillActive=function(){var b;if(this.queue.length)for(var p=0;p<this.cnf.maxLoadParallel-this.activeElements.length;p++){b=this.queue.shift();if(!b)break;this.imageEvents.forEach(function(f){b.image[f]=this._createImageHandler(b.image[f])},this);b.image.src=b.src;this.activeElements.push(b.image)}}}}(jQuery),function(b){var r="css",g=phx.util.userAgent.is("ff")?"fade":
"fadeanimate",p=!0,f,k,h,w=0,P,t,n=[],l=-1,q={},u=null,x=!1,F=!1,G=-1,H=new phx.loader.ImageQueue({maxLoadParallel:4}),B=function(a,c,b){var d="next"===a?"left":"right";return c.length?(c[a](".item").length?b||f.find(".click-"+d+"-area").removeClass("disabled"):f.find(".click-"+("left"===d?"right":"left")+"-area").addClass("disabled"),!0):!1},I=function(a){f.find(".click-left-area, .click-right-area").removeClass("disabled");B("next",a,!0);B("prev",a,!0)},Q=function(a){a.stop(!0,!0);var c=a.find(".thumbcontainer"),
b=c.find("img");c.stop(!0,!0);a.css({backgroundColor:"",marginTop:"",width:"118px"}).removeClass("scaled selected");c.css({opacity:"0.3",width:"",height:""});b.css({height:b.data("smallHeight"),width:b.data("smallWidth"),"margin-top":"-"+Math.floor(b.data("smallHeight")/2)+"px","margin-left":"-"+Math.floor(b.data("smallWidth")/2)+"px"})},C=function(a){var c=a.find(".thumbcontainer img");a.addClass("selected");if(x)a[r]({"background-color":"white"}),a.find(".thumbcontainer").css("opacity",1);else if(a.addClass("scaled"),
a[r]({marginTop:10,backgroundColor:"white",width:"142px"},300),a.find(".thumbcontainer")[r]({width:140,height:140,opacity:1},300),c.data("bigWidth"))c[r]({width:c.data("bigWidth"),height:c.data("bigHeight")+2,"margin-top":"-"+Math.floor(c.data("bigHeight")/2)+"px","margin-left":"-"+Math.floor(c.data("bigWidth")/2)+"px"})},z=function(a,c){var d,e,m,y,g,k,J;e="object"===typeof a?a:h.eq(a);d=l;m=l=e.index(".stage .carousel-navi\x3ediv");y=e.data().attSrc;g=new Image;k=d>m;J=h.eq(d);if(d!==m){c&&K(-140*
(0===m?1:m-1),!0);K(-140*m);J&&Q(J);if(!c&&(C(e),d=b("#slideshow-background").get(0),d.onload))d.onload({});t.hide();n[m]||f.append(b('\x3cdiv class\x3d"spinner"\x3e\x3c/div\x3e'));f.find(".detail-images .detail-image").hide();d=function(){R(m,this,e);m===l&&S(n[m],e,k,c)};q[y]?n[m]?S(n[m],e,k,c):q[y].onload=d:(q[y]=g,g.onload=d,g.src=y);c?G=m:window.setTimeout(function(){T(m)},0);return e}},T=function(a){for(var c=a+2,b;0<=c&&c>a-3;)b=h.eq(c).data("att-src"),h[c]&&!q[b]&&(q[b]=new Image,q[b].onload=
function(a){return function(){R(a,this,h.eq(a))}}(c),H.add({image:q[b],src:b})),c--},R=function(a,c,d){n[a]||(c&&c.width&&c.height&&d&&d.data("att-orig-width",c.width).data("att-orig-height",c.height),n[a]=b('\x3cdiv class\x3d"detail-image"\x3e\x3cimg width\x3d"100%"/\x3e\x3c/div\x3e'),n[a].appendTo(".stage .detail-images"))},S=function(a,c,b,e){var d;L();a.css("max-width",c.data("att-orig-width")+"px").find("img").attr("src",c.data("att-src"));f.find(".detail-images .detail-image").hide();U(a,c.data(),
!0);f.children(".spinner").remove();"show"===g?(a.show().find("img").show(),t.show()):"fade"===g?(t.show(),a.fadeIn(400),a.find("img").show()):(d=a.find("img"),d.css({"margin-left":"animate"===g||"fadeanimate"===g?(b?"-":"")+"40px":"0px",display:"block",opacity:"fadeanimate"===g?0:1}),a.show(),a="fadeanimate"===g?{"margin-left":0,opacity:1}:{"margin-left":0},d.stop(!0,!0).animate(a,400),t.delay(500).show());e&&(e(),C(c))},aa=function(){b(".stage .carousel-navi-wrapper")[p?"animate":"css"]({bottom:-134});
var a=b(".stage .carousel-navi-wrapper .item").eq(l);Q(a);x=!0;b(".stage .carousel-navi-wrapper .center-container").css("margin-left",-76);C(a);phx.ftd.closeAllWithin(b(".stage-wrapper"))},v=function(){null!==u&&window.clearTimeout(u);u=window.setTimeout(aa,1E3)},M=function(){null!==u&&(window.clearTimeout(u),u=null)},ca=function(){F=!0;M();x&&ba()},ba=function(a){p?b(".stage .carousel-navi-wrapper").animate({bottom:0},300,null,function(){a&&v()}):(b(".stage .carousel-navi-wrapper").css({bottom:0}),
a&&v());x=!1;b(".stage .carousel-navi-wrapper .center-container")[r]({marginLeft:"-88px"});C(b(".stage .carousel-navi-wrapper .item").eq(l))},da=function(){b(".stage .carousel-navi-wrapper").on({mouseleave:function(){F=!1;phx.gallery.preventHideCarousel||v()},mouseenter:ca});v()},V=null,U=function(a,c,d){phx.ftd.closeAllWithin(b(".stage-wrapper"));if(h[l]){a=b(a.target?n[l]:a);var e=e||b(h[l]).data();a.get(0)&&(f.height()>e.attOrigHeight?a[0].style.width="auto":f.width()/f.height()>e.attOrigWidth/
e.attOrigHeight?(c=Math.floor(e.attOrigWidth/e.attOrigHeight*f.height()),a[0].style.width=c+"px"):a[0].style.width="auto");t.css("margin-top",-1*(t.height()/2)+"px");d=!0===d?f.height()>e.attOrigHeight?f.width()>e.attOrigWidth?e.attOrigHeight:Math.floor(e.attOrigHeight/e.attOrigWidth*f.width()):f.width()>e.attOrigWidth?f.height():Math.floor(e.attOrigHeight/e.attOrigWidth*f.width()):a.height();d=Math.floor((f.height()-d)/2);a.get(0)&&(a[0].style.paddingTop=(0>d?0:d)+"px");window.clearTimeout(V);V=
window.setTimeout(ea,100)}},ea=function(){L();W()},L=function(){F||v();b(".carousel-navi .title.active").removeClass("active")},D=[],fa=function(a){var c=b(a.target);c.hasClass("ctx-menu")||c.hasClass("title")||c.parent().hasClass("title")||(c=c.closest(".item"),I(c),z(c));a.preventDefault()},X=function(){h=b(".stage .carousel-navi\x3ediv.item");k.css("width",140*h.length+154+"px");f.find(".carousel-navi\x3ediv.new").each(function(a){var c=b(this),d,e=new Image,f=c.hasClass("scaled");c.removeClass("new");
c.attr("unselectable","on");c.append(b('\x3cdiv unselectable\x3d"on" class\x3d"thumbcontainer"\x3e\x3cdiv class\x3d"selectblocker"  unselectable\x3d"on"\x3e\x3c/div\x3e\x3cimg unselectable\x3d"on" style\x3d"display:none"/\x3e\x3c/div\x3e'));c.append('\x3cdiv class\x3d"attachments"\x3e\x3cspan class\x3d"attachmenttype is-type-img"\x3e'+c.data("att-type").toUpperCase()+"\x3c/span\x3e\x3c/div\x3e");c.find(".thumbcontainer").append(b('\x3cdiv class\x3d"spinner"\x3e\x3c/div\x3e'));c.find(".title").attr("title",
c.data("att-name"));c.click(fa);d=c.find(".thumbcontainer img");d.css({height:f?"116px":"140px",width:f?"116px":"140px"});c.width((f?154:130)-12);e.onload=function(){var a,b,e,f;this.height>this.width?(b=116,a=this.height/this.width*b,e=140,f=this.height/this.width*e):(a=116,b=this.width/this.height*a,f=140,e=this.width/this.height*f);d.data("smallWidth",b);d.data("smallHeight",a);d.data("bigWidth",e);d.data("bigHeight",f);b=c.hasClass("scaled")?e:b;a=c.hasClass("scaled")?f:a;c.width((c.hasClass("scaled")?
154:130)-12);d.css({display:"block",height:a+"px",width:b+"px","margin-top":"-"+Math.floor(a/2)+"px","margin-left":"-"+Math.floor(b/2)+"px"}).attr("src",this.src).find(".spinner").remove()};D[a]={image:e,src:c.data("att-thumb-src")}});-1<G&&T(G)},E=0,A=0,N=!1,Y=function(a){N||(N=!0,"css"!==r||"show"!==g?(r="css",g="show",a?p=!1:N=!1):p=!1)},ga=function(){var a=k[0].style.marginLeft?parseInt(k[0].style.marginLeft,10):0;0!==A&&(Math.abs(A)>Math.abs(-1*(a-w))?(A=0,a=(new Date).getTime()-E,650<a&&(1E3<
a?Y(!0):Y()),E=0,k[0].style.marginLeft=w+"px",W()):(0===E&&(E=(new Date).getTime()),k[0].style.marginLeft=a+A+"px"))},K=function(a,b){w=a;!p||b?k[0].style.marginLeft=w+"px":k&&k[0]&&k[0].style&&(A=-1*((k[0].style.marginLeft?parseInt(k[0].style.marginLeft,10):0)-w)/6)},O=!0,Z=function(a){var c,d,e;c=b(a);a=f.position();e=c.offset().left;c=c.outerWidth();d=f.outerWidth();return e+c>=a.left&&e<a.left+d},W=function(){for(var a,b=a=l,d=l;0<a&&Z(h.get(a));)b=a,a--;for(a=l;a<h.length&&Z(h.get(a));)d=a,a++;
a=0>b-2?0:b-2;for(d=d+2>h.length-1?h.length-1:d+2;d>=a;d--)null!==D[d]&&(H.add(D[d]),D[d]=null)};phx.gallery={};phx.gallery.imageQueue=H;phx.gallery.placeOnStage=function(a){I(z(a))};phx.gallery.reload=X;phx.gallery.init=function(a){b("body");b(document).scrollTop(0).scrollLeft(0);O&&(O=!1,phx.event.publish(phx.events.MODAL_DIALOG_OPEN),b("html").addClass("slideshow-visible"),K(0),window.clearInterval(P),n=[],l=-1,q={},u=null,x=!1,h=b(".stage .carousel-navi\x3ediv.item"),f=b(".stage"),k=b(".stage .carousel-navi"),
t=b(".stage .radial-background img"),da(),I(z(a,X)),P=window.setInterval(ga,50),b('\x3cdiv class\x3d"carousel-navi-bg"\x3e\x3c/div\x3e').appendTo(".stage .carousel-navi-wrapper"),b(".click-left-area").click(function(){var a=b(h[l]).prev(".item");B("prev",a)&&(b(".click-right-area").removeClass("disabled"),z(a))}),b(".click-right-area").click(function(){var a=b(h[l]).next(".item");B("next",a)&&(b(".click-left-area").removeClass("disabled"),z(a))}),b(".right-button a").click(function(){var a=f.closest(".stage-wrapper");
phx.ftd.closeAllWithin(a);a.children().remove();a.removeClass("stage-wrapper");b("html").removeClass("slideshow-visible");phx.closeLayer();O=!0}),b(".carousel-navi [data-ftd-trigger]").on({"preopen.ftd":function(){M();phx.gallery.preventHideCarousel=!0;b(this).closest(".title").addClass("active")},"close.ftd":function(){phx.gallery.preventHideCarousel=!1;phx.gallery.correctCarouselStateOnFlyoutClose()}}))};phx.gallery.stopHideCarouselTimer=M;phx.gallery.startHideCarouselTimer=v;phx.gallery.correctCarouselStateOnFlyoutClose=
L;phx.gallery.preventHideCarousel=!1;b(document).ready(function(){b(window).resize(U)})}(jQuery));